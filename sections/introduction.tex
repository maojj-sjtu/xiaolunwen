\section{Introduction}
\label{Introduction}
During the last decade, the Internet of Things(IoT) technologies have been much more widely applied in both enterprise manufacturing and people's daily life. Concepts like Smart City, Intelligent Manufacturing, E-health are all closely bound up to IOT technologies. As increasing numbers of IoT devices (e.g., sensors, actuators, embeded devices, RFID) are getting connected to the World Wide Web(WWW)\cite{guinard2011internet}, the Web of Things(WoT) architecture offers us a new platform which enables us to manage and integrate the smart things in a much easier way with looser coupling and better scalability. 

Different from the IoT that focuses on the network layer connectivity between physical devices in various constrained networking environments, the WoT focuses on integrating smart things into the application layer, the top level of the Internet. Web servers are embeded into smart things and the physical resources are exposed to the Internet as RESTful Web Services\cite{guinard2010resource}. Compared with the traditional heavyweight Web Service technologies based on standards such as SOAP, WSDL, and UDDI , RESTful Web Service can be accessed in a easier way through HTTP or HTTPS protocol. In the RESTful architecture, all the resources are identified and  encapsulated uniquely through the Universal Resource Identifiers(URIs), which can effectively solve the problems caused by the variability of data structure and data transmission mode between different devices and make the information exchange become more efficient through different programming languages, different platforms, and different devices\cite{pautasso2008restful}.  

As massive smart things are accessable in WoT environment, simple service invocation can hardly meet the requirement of increasingly complex applications. Therefore, our demand for business process management and service composition technologies in WoT environment is becoming very urgent. Business Process Execution Language(BPEL) is one of the most frequently used process definition standard\cite{jordan2003web}. BPEL binds business activities and Web Services and control the business processes with workflow, so as to execute complex business processes by service composition. However, such bindings refer actual service instances instead of service  interfaces during the process definition phase, which will make high coupling between processes and devices in WoT. There are lots of smart things that offer the same functionalities but were produced by different manufacturers, which means that the Application Programming Interface(API), parameters, and constraints of those smart things are different. For example, there are hundreds of different models of charging pile produced by nearly a hundred charging pile manufacturers. Because of the variety of the device interface, itâ€™s very complicated to reuse a BPEL specification between different device environment, and a simple replacement of devices may lead to the rewriting of the entire specification. 

In order to solve the defects above and allow users to define and make use of the business process management and service composition technologies more conveniently, we propose a device-adaptive service composition framework for WoT environment. In the framework, we design an activity description model and a general service model. In the activity description model, by using ontology to construct a semantic extension of a business activity in BPEL, we can overcome the shortcoming of directly binding the process and the service and  make the process specification more reusable with the more abstract definition. Then, a matching mechanism between the model and the Web Application Description Language(WADL) is proposed to select available services from all the services of the device. The matching result is represented by a general service model, which contains the references to actual service instances. According to the general service model, source code of the general service can be automatically generated. The source code  will be deployed on the device to publish the composited service for the business activity, so that users only need to interact with such service during the process execution and should pay no attention to the origin services on the device, which decouple the process specification and the actual device services. Through this approach, once the business activity should be reused in other device environment, we can generate the general services on the new devices automatically instead of redefine the entire process. 

The remainder of the paper is organized as follows. In Section~\ref{Related Work}, we introduce some existing semantic related business process and service composition technologies, and make a comparision with our approach. The overall architecture of our framework is briefly presented in Section~\ref{Framework}. In Section~\ref{Approach}, we describe our activity description model, general service model, algorithms for matching and code generation in detail. Then, there is a case study about applying our framework in a scene of intelligent charging piles in Section~\ref{CaseStudy} and we draw our conclusions in Section~\ref{Conclusion}. 
